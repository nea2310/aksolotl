(()=>{"use strict";const t={min:0,max:0,from:0,to:0,vertical:!1,range:!0,bar:!0,tip:!0,scale:!0,scaleBase:"step",step:0,interval:0,sticky:!1,shiftOnKeyDown:0,shiftOnKeyHold:0,onStart:()=>!0,onChange:()=>!0,onUpdate:()=>!0},i={type:"",clientY:0,clientX:0,top:0,left:0,width:0,height:0,shiftBase:0,moovingControl:"min",direction:"ArrowLeft",repeat:!1},s={fromPosition:0,toPosition:0,marksArray:[{position:0,value:0}],intervalValue:"",stepValue:"",scaleBase:"step",fromValue:"",toValue:"",thumb:i};class e{constructor(){this.observers=[]}subscribe(t){return!this.observers.includes(t)&&(this.observers.push(t),this.observers)}unsubscribe(t){return this.observers=this.observers.filter((i=>i!==t)),this.observers}notify(i,s,e=t){this.observers.forEach((t=>t({key:i,data:s,conf:e})))}}var o=function(t,i,s,e){return new(s||(s=Promise))((function(o,a){function n(t){try{r(e.next(t))}catch(t){a(t)}}function h(t){try{r(e.throw(t))}catch(t){a(t)}}function r(t){var i;t.done?o(t.value):(i=t.value,i instanceof s?i:new s((function(t){t(i)}))).then(n,h)}r((e=e.apply(t,i||[])).next())}))};class a extends e{constructor(e){super(),this.changeMode=!1,this.dataAttributesConf={},this.conf=t,this.data=Object.assign(Object.assign({},s),{thumb:Object.assign({},i)}),this.methods={calcFromPosition:!1,calcToPosition:!1,calcScaleMarks:!1,switchVertical:!1,switchRange:!1,switchScale:!1,switchBar:!1,switchTip:!1,updateControlPos:!1},this.startConf=e,this.needCalcValue=!0}getConf(t){this.dataAttributesConf=t;const i=Object.assign(Object.assign(Object.assign({},this.conf),this.startConf),this.dataAttributesConf);return this.conf=a.checkConf(i),this.conf}start(){this.onStart=this.conf.onStart,this.onUpdate=this.conf.onUpdate,this.onChange=this.conf.onChange,this.calcScaleMarks(),this.calcFromPosition(),this.calcToPosition(),"function"==typeof this.onStart&&this.onStart(this.conf)}getData(){return this.conf}calcPositionSetByPointer(t){const{type:i,clientY:s,clientX:e,top:o,left:a,width:n,height:h,shiftBase:r,moovingControl:l}=t;let c=0;if(this.conf.vertical)c=100-100*(s-o)/h;else{let t=0;"pointermove"===i&&(t=100*r/n),c=100*(e-a)/n-t}this.conf.sticky&&(c=this.setSticky(c));let d=!1;if(c<0)return d=!0,this.calcValue("min",0,l),"function"==typeof this.onChange&&this.onChange(this.conf),"newPosition < 0";if(c>100)return d=!0,this.calcValue("max",0,l),"function"==typeof this.onChange&&this.onChange(this.conf),"newPosition > 100";if(this.conf.range){if("min"===l&&c>this.data.toPosition)return d=!0,this.calcValue("meetMax",0,l),"newPosition > toPosition";if("max"===l&&c<this.data.fromPosition)return d=!0,this.calcValue("meetMin",0,l),"newPosition < fromPosition"}return"min"===l?(this.data.fromPosition=c,this.notify("FromPosition",this.data,this.conf)):(this.data.toPosition=c,this.notify("ToPosition",this.data,this.conf)),d||this.calcValue("normal",c,l),"function"==typeof this.onChange&&this.onChange(this.conf),c}calcPositionSetByKey(t){const{direction:i,repeat:s,moovingControl:e}=t,o=t=>(this.conf.from=t.value,this.data.fromPosition=t.position,this.data.fromValue=String(t.value),this.notify("FromPosition",this.data),this.notify("FromValue",this.data),{newValue:String(t.value),newPosition:t.position}),a=t=>(this.conf.to=t.value,this.data.toPosition=t.position,this.data.toValue=String(t.value),this.notify("ToPosition",this.data),this.notify("ToValue",this.data),{newValue:String(t.value),newPosition:t.position}),n=t=>s?this.data.marksArray[t+this.conf.shiftOnKeyHold]:this.data.marksArray[t+this.conf.shiftOnKeyDown],h=t=>s?this.data.marksArray[t-this.conf.shiftOnKeyHold]:this.data.marksArray[t-this.conf.shiftOnKeyDown];let r,l,c;if(this.conf.sticky)if("min"===e){const t=this.data.marksArray.findIndex((t=>t.value===this.conf.from));if("ArrowRight"===i||"ArrowUp"===i){if(l=n(t),void 0===l)return"newPosition>100";c=l.value>this.conf.from&&(this.conf.range&&l.value<=this.conf.to||!this.conf.range&&l.value<=this.conf.max)?o(l):"too big newPosition"}else{if(l=h(t),void 0===l)return"newPosition<0";c=this.conf.range&&l.value<this.conf.to||!this.conf.range?o(l):"too small newPosition"}}else{const t=this.data.marksArray.findIndex((t=>t.value===this.conf.to));if("ArrowRight"===i||"ArrowUp"===i){if(l=n(t),void 0===l)return"newPosition>100";c=l&&l.value>this.conf.to&&this.conf.to<this.conf.max?a(l):"too big newPosition"}else{if(l=h(t),void 0===l)return"newPosition<0";c=l.value>=this.conf.from&&this.conf.to>this.conf.from?a(l):"too small newPosition"}}else{if(this.needCalcValue=!1,"min"===e){if("ArrowRight"===i||"ArrowUp"===i){const t=this.conf.range&&this.conf.from<this.conf.to,i=!this.conf.range&&this.conf.from<this.conf.max,e=this.conf.range&&this.conf.from>=this.conf.to,o=!this.conf.range&&this.conf.from>=this.conf.max;(t||i)&&(r=s?this.conf.from+this.conf.shiftOnKeyHold:this.conf.from+this.conf.shiftOnKeyDown,this.conf.range&&r>this.conf.to&&(r=this.conf.to),!this.conf.range&&r>this.conf.max&&(r=this.conf.max)),e&&(r=this.conf.to),o&&(r=this.conf.max)}else this.conf.from>this.conf.min?(r=s?this.conf.from-this.conf.shiftOnKeyHold:this.conf.from-this.conf.shiftOnKeyDown,r<this.conf.min&&(r=this.conf.min)):r=this.conf.min;this.data.fromValue=String(r),this.conf.from=Number(r),this.calcFromPosition(),this.notify("FromValue",this.data),c=r}else"ArrowRight"===i||"ArrowUp"===i?this.conf.to<this.conf.max?(r=s?this.conf.to+this.conf.shiftOnKeyHold:this.conf.to+this.conf.shiftOnKeyDown,r>this.conf.max&&(r=this.conf.max)):r=this.conf.max:this.conf.to>this.conf.from?(r=s?this.conf.to-this.conf.shiftOnKeyHold:this.conf.to-this.conf.shiftOnKeyDown,r<this.conf.from&&(r=this.conf.from)):r=this.conf.from,this.data.toValue=String(r),this.conf.to=r,this.calcToPosition(),this.notify("ToValue",this.data),c=r;this.needCalcValue=!0}return"function"==typeof this.onChange&&this.onChange(this.conf),c}static checkConf(t){let i=t;const s=t=>Number.isNaN(+t)?0:+t,e=t=>!0===t||"true"===t,o=["min","max","from","to","step","interval","shiftOnKeyDown","shiftOnKeyHold"],a=["vertical","range","sticky","scale","bar","tip"],n=Object.entries(i),h=(t,s,e)=>{const o={[t]:s=e(s)};i=Object.assign(Object.assign({},i),o)};n.forEach((t=>{const[i,n]=t;return o.includes(i)?(h(i,n,s),!0):!a.includes(i)||(h(i,n,e),!0)}));const r=(t,s)=>{if(s<=0)switch(t){case"step":return(i.max-i.min)/2;case"interval":return 2;default:return 1}return s};return i.scaleBase="step"!==i.scaleBase&&"interval"!==i.scaleBase?"step":i.scaleBase,i.shiftOnKeyDown=r("shiftOnKeyDown",i.shiftOnKeyDown),i.shiftOnKeyHold=r("shiftOnKeyHold",i.shiftOnKeyHold),i.max=i.max<=i.min?i.min+10:i.max,i.to=i.max<=i.min?i.min+10:i.to<i.min?i.from:i.to>i.max?i.range?i.max:i.from:i.to,i.from=i.max<=i.min||i.from<i.min?i.min:i.from>i.max?i.range?i.to-10:i.max:i.range&&i.from>i.to?i.min:i.from,i.step=r("step",i.step),i.interval=r("interval",i.interval),i}update(t){let i=Object.assign(Object.assign({},this.conf),t);i=a.checkConf(i),this.findChangedConf(this.conf,i),this.conf=i;const s=Object.keys(this.methods);return s.forEach((t=>{const i=t;this.methods[i]&&this[i]()})),"function"==typeof this.onUpdate&&this.onUpdate(this.conf),s.forEach((t=>{const i=t;this.methods[i]&&(this.methods[i]=!1)})),this.needCalcValue=!0,Object.assign(Object.assign({},this.conf),this.data)}findChangedConf(t,i){return Object.keys(i).forEach((s=>{const e=s;if(i[e]!==t[e])switch(e){case"min":case"max":this.needCalcValue=!0,this.methods.calcScaleMarks=!0,this.methods.calcFromPosition=!0,this.methods.calcToPosition=!0;break;case"from":this.methods.calcFromPosition=!0;break;case"to":this.methods.calcToPosition=!0;break;case"step":case"interval":this.methods.calcScaleMarks=!0,this.methods.updateControlPos=!0;break;case"scaleBase":this.methods.calcScaleMarks=!0;break;case"vertical":this.methods.switchVertical=!0;break;case"range":this.methods.switchRange=!0;break;case"scale":this.methods.switchScale=!0;break;case"bar":this.methods.switchBar=!0;break;case"tip":this.methods.switchTip=!0;break;case"sticky":this.methods.updateControlPos=!0;break;case"onStart":i.onStart&&(this.conf.onStart=i.onStart,this.onStart=i.onStart);break;case"onChange":(i.onChange||null===i.onChange)&&(this.conf.onChange=i.onChange,this.onChange=i.onChange);break;case"onUpdate":i.onUpdate&&(this.conf.onUpdate=i.onUpdate,this.onUpdate=i.onUpdate);break;default:return!0}return!0})),this.methods}switchVertical(){return o(this,void 0,void 0,(function*(){yield this.notify("IsVertical",this.data,this.conf),this.calcFromPosition(),this.calcToPosition(),this.calcScaleMarks()}))}switchRange(){this.notify("IsRange",this.data,this.conf),"function"==typeof this.onChange&&this.onChange(this.conf)}updateControlPos(){this.calcFromPosition(),this.calcToPosition(),"function"==typeof this.onChange&&this.onChange(this.conf),this.notify("IsSticky",this.data,this.conf)}switchScale(){this.notify("IsScale",this.data,this.conf)}switchBar(){this.notify("IsBar",this.data,this.conf)}switchTip(){this.notify("IsTip",this.data,this.conf)}setSticky(t){let i=this.data.marksArray.find(((i,s,e)=>{let o=0;return s<e.length-1&&(o=e[s+1].position),Math.abs(t-i.position)<Math.abs(t-o)}));return i||(i={value:0,position:0}),i.position}calcFromPosition(){this.data.fromPosition=100*(this.conf.from-this.conf.min)/(this.conf.max-this.conf.min),this.conf.sticky&&(this.data.fromPosition=this.setSticky(this.data.fromPosition)),this.needCalcValue&&this.calcValue("normal",this.data.fromPosition,"min"),this.notify("FromPosition",this.data,this.conf)}calcToPosition(){this.data.toPosition=100*(this.conf.to-this.conf.min)/(this.conf.max-this.conf.min),this.conf.sticky&&(this.data.toPosition=this.setSticky(this.data.toPosition)),this.needCalcValue&&this.calcValue("normal",this.data.toPosition,"max"),this.notify("ToPosition",this.data,this.conf)}calcScaleMarks(){let t=1,i=1;if("step"===this.conf.scaleBase){i=this.conf.step,t=(this.conf.max-this.conf.min)/i;const s=String(t%1==0?t:Math.trunc(t+1));this.data.scaleBase="step",this.data.intervalValue=s,this.data.stepValue=String(this.conf.step),this.conf.interval=parseFloat(s)}if("interval"===this.conf.scaleBase){t=this.conf.interval,i=(this.conf.max-this.conf.min)/t;const s=String(i%1==0?i:i.toFixed(2));this.data.scaleBase="interval",this.data.intervalValue=String(t),this.data.stepValue=s,this.conf.step=parseFloat(s)}this.data.marksArray=[{value:this.conf.min,position:0}];let s=this.conf.min;for(let e=0;e<t;e+=1){const t={value:0,position:0};if(s+=i,s<=this.conf.max){const i=100*(s-this.conf.min)/(this.conf.max-this.conf.min);t.value=parseFloat(s.toFixed(2)),t.position=i,this.data.marksArray.push(t)}}this.data.marksArray[this.data.marksArray.length-1].value<this.conf.max&&this.data.marksArray.push({value:this.conf.max,position:100}),this.notify("Scale",this.data,this.conf)}calcValue(t,i,s){const e={normal:(this.conf.min+(this.conf.max-this.conf.min)*i/100).toFixed(0),min:String(this.conf.min),max:String(this.conf.max),meetMax:String(this.conf.to),meetMin:String(this.conf.from)};if(!this.changeMode){const i=e[t];"min"===s?(this.data.fromValue=i,this.conf.from=parseFloat(i),this.notify("FromValue",this.data)):(this.data.toValue=i,this.conf.to=parseFloat(i),this.notify("ToValue",this.data))}}}const n=a;class h{constructor(t){this.slider=t,this.render()}render(){this.track=h.getElement(this.slider,".slider-metalamp__track"),this.progressBar=document.createElement("div"),this.progressBar.className="slider-metalamp__progress-bar",this.track.append(this.progressBar)}static getElement(t,i){return t.querySelector(i)}updateBar(t,i,s,e){let o=0,a=t;if(s&&(o=t,a=i-t),this.progressBar){const{style:t}=this.progressBar;e?(t.bottom=`${o}%`,t.height=`${a}%`,t.left="",t.width=""):(t.left=`${o}%`,t.width=`${a}%`,t.bottom="",t.height="")}}}const r=h;class l extends e{constructor(t,e){super(),this.initDone=!1,this.defineControl=t=>!!t.classList&&(t.classList.contains("slider-metalamp__control-min")?"min":"max"),this.slider=t,this.data=Object.assign(Object.assign({},s),{thumb:Object.assign({},i)}),this.conf=e,this.render(),this.init(e),this.dragControl(),this.pressControl(),this.clickTrack()}render(){this.root=this.slider.previousElementSibling,this.track=this.slider.firstElementChild,this.controlMin=l.renderControl("slider-metalamp__control-min","slider-metalamp__tip-min",this.conf.from),this.tipMin=l.getElement(this.controlMin,".slider-metalamp__tip"),this.track.append(this.controlMin),this.controlMax=l.renderControl("slider-metalamp__control-max","slider-metalamp__tip-max",this.conf.to),this.tipMax=l.getElement(this.controlMax,".slider-metalamp__tip"),this.track.append(this.controlMax)}updatePos(t,i){const s=t;return this.initDone||(this.initDone=!0),this.conf.vertical?(s.style.bottom=`${i}%`,s.style.left=""):(s.style.left=`${i}%`,s.style.bottom=""),!(!this.tipMin||!this.tipMax)&&("min"===this.defineControl(s)?this.tipMin.style.left=l.calcTipPos(this.conf.vertical,this.tipMin):this.tipMax.style.left=l.calcTipPos(this.conf.vertical,this.tipMax),!0)}updateVal(t,i){return!(!this.tipMin||!this.tipMax)&&(i?this.tipMin.innerText=t:this.tipMax.innerText=t,!0)}updateInput(t){this.root&&"INPUT"===this.root.tagName&&(this.root.value=this.conf.range?`${t.from}, ${t.to}`:String(t.from))}switchVertical(t){this.conf=t}switchTip(t){this.tipMax&&this.tipMin&&this.initDone&&(this.tipMax.style.left=l.calcTipPos(t.vertical,this.tipMax),this.tipMin.style.left=l.calcTipPos(t.vertical,this.tipMin))}static calcTipPos(t,i){return t?-1*i.offsetWidth-5+"px":i.offsetWidth/2*-1+"px"}static getElement(t,i){return t.querySelector(i)}static renderControl(t,i,s){const e=document.createElement("button");e.className="slider-metalamp__control",e.classList.add(t);const o=document.createElement("span");return o.className="slider-metalamp__tip",o.classList.add(i),o.innerText=String(s),e.append(o),e}init(t){this.conf=t}getMetrics(t){const i=t.parentElement,{thumb:s}=this.data;s.top=i.getBoundingClientRect().top,s.left=i.getBoundingClientRect().left,s.width=i.offsetWidth,s.height=i.offsetHeight}dragControl(){const t=()=>!1;this.slider.addEventListener("pointerdown",(t=>{t.preventDefault();const{target:i}=t;if(!(i instanceof HTMLElement))throw new Error("Cannot handle move outside of DOM");i.classList.contains("slider-metalamp__control")&&i.classList.add("slider-metalamp__control_grabbing");const{thumb:s}=this.data;if(i.classList.contains("slider-metalamp__control")){const e=this.defineControl(i);"string"==typeof e&&(s.moovingControl=e),this.conf.vertical||(s.shiftBase=t.clientX-i.getBoundingClientRect().left),this.getMetrics(i);const o=t=>{s.type="pointermove",s.clientX=t.clientX,s.clientY=t.clientY,this.notify("MoveEvent",this.data)},a=()=>{i.classList.remove("slider-metalamp__control_grabbing"),i.removeEventListener("pointermove",o),i.removeEventListener("pointerup",a)};i.setPointerCapture(t.pointerId),i.addEventListener("pointermove",o),i.addEventListener("pointerup",a)}})),this.slider.addEventListener("dragstart",t),this.slider.addEventListener("selectstart",t)}pressControl(){this.slider.addEventListener("keydown",(t=>{if(-1!==["ArrowLeft","ArrowDown","ArrowRight","ArrowUp"].indexOf(t.code)){t.preventDefault();const{target:i}=t;if(!(i instanceof HTMLElement))throw new Error("Cannot handle move outside of DOM");const{thumb:s}=this.data;i.classList.contains("slider-metalamp__control")&&(s.moovingControl=i.classList.contains("slider-metalamp__control-min")?"min":"max",s.direction=t.code,s.repeat=t.repeat,this.notify("KeydownEvent",this.data))}}))}clickTrack(){this.slider.addEventListener("pointerdown",(t=>{t.preventDefault();const{target:i}=t;if(!(i instanceof HTMLElement))throw new Error("Cannot handle move outside of DOM");const{thumb:s}=this.data,e=["slider-metalamp__track","slider-metalamp__progressBar","slider-metalamp__label","slider-metalamp__mark","slider-metalamp__frame"];if([...i.classList].some((t=>-1!==e.indexOf(t)))){let i=0,e=0;this.controlMin&&this.controlMax&&(this.conf.vertical?(i=Math.abs(this.controlMin.getBoundingClientRect().bottom-t.clientY),e=Math.abs(this.controlMax.getBoundingClientRect().bottom-t.clientY)):(i=Math.abs(this.controlMin.getBoundingClientRect().left-t.clientX),e=Math.abs(this.controlMax.getBoundingClientRect().left-t.clientX))),this.track&&(s.top=this.track.getBoundingClientRect().top,s.left=this.track.getBoundingClientRect().left,s.width=Number(this.track.offsetWidth),s.height=Number(this.track.offsetHeight),s.type="pointerdown",s.clientX=t.clientX,s.clientY=t.clientY),this.controlMax&&this.controlMax.classList.contains("hidden")?s.moovingControl="min":s.moovingControl=i<=e?"min":"max",this.notify("MoveEvent",this.data)}}))}}const c=l;const d=class{constructor(t,i,s,e=[]){this.startWidth=0,this.markList=[],this.lastLabelRemoved=!1,this.scaleMarks=[],this.calcMarkList=!1,this.conf=s,this.slider=t,this.track=i,0===e.length?this.calcMarkList=!0:this.markList=e}createScale(t,i){this.conf=i,this.scaleMarks=t;const s=this.slider.querySelectorAll(".js-slider-metalamp__mark");return this.calcMarkList&&(s.length&&s.forEach((t=>t.remove())),t.forEach((t=>{const s=document.createElement("div");s.classList.add("slider-metalamp__mark"),s.classList.add("js-slider-metalamp__mark");const e=document.createElement("div");e.innerText=String(t.value),e.classList.add("slider-metalamp__label"),s.appendChild(e),i.vertical?s.style.bottom=`${String(t.position)}%`:s.style.left=`${String(t.position)}%`,i.scale||s.classList.add("slider-metalamp__mark_visually-hidden"),this.track.appendChild(s),i.vertical?e.style.top=e.offsetHeight/2*-1+"px":e.style.left=e.offsetWidth/2*-1+"px"})),this.markList=[...this.track.querySelectorAll(".js-slider-metalamp__mark")]),this.resize(),this.checkScaleLength(this.markList)}checkScaleLength(t){const i=t=>{for(let i=1;i<t.length;i+=2){t[i].firstElementChild.classList.add("slider-metalamp__label_hidden"),t[i].classList.add("slider-metalamp__mark_no-label"),t[i].classList.add("js-slider-metalamp__mark_no-label")}this.markList=[...this.track.querySelectorAll(".js-slider-metalamp__mark:not(.js-slider-metalamp__mark_no-label)")],this.lastLabelRemoved=!0,this.checkScaleLength(this.markList)};if(this.conf.vertical){let s=0;if(t.forEach((t=>{const i=t.firstElementChild;s+=i.getBoundingClientRect().height})),!(s>this.track.offsetHeight))return this.lastLabelRemoved&&this.addLastLabel(this.lastLabelRemoved),this.markList;i(t)}else{let s=0;if(t.forEach((t=>{const i=t.firstElementChild;s+=i.getBoundingClientRect().width})),!(s>this.track.offsetWidth))return this.lastLabelRemoved&&this.addLastLabel(this.lastLabelRemoved),this.markList;i(t)}return this.markList}addLastLabel(t){const i=this.track.querySelectorAll(".js-slider-metalamp__mark:not(.js-slider-metalamp__mark_no-label)"),s=i[i.length-1],e=this.track.querySelector(".js-slider-metalamp__mark:last-child");if(t){s.classList.add("slider-metalamp__mark_no-label"),s.classList.add("js-slider-metalamp__mark_no-label");s.firstElementChild.classList.add("slider-metalamp__label_hidden"),e.classList.remove("slider-metalamp__mark_no-label"),e.classList.remove("js-slider-metalamp__mark_no-label");e.firstElementChild.classList.remove("slider-metalamp__label_hidden")}}resize(){this.startWidth=this.slider.offsetWidth;window.addEventListener("resize",(()=>{const t=this.slider.offsetWidth;t!==this.startWidth&&(t<this.startWidth&&this.checkScaleLength(this.markList),t>this.startWidth&&this.createScale(this.scaleMarks,this.conf),this.startWidth=t)}))}};const m=class extends e{constructor(i){super(),this.dataAttributesConf={},this.conf=t,this.handleMoveEvent=t=>{"MoveEvent"===t.key&&this.notify("MoveEvent",t.data)},this.handleKeydownEvent=t=>{"KeydownEvent"===t.key&&this.notify("KeydownEvent",t.data)},this.root=i,this.render(),this.collectParms()}render(){this.slider=document.createElement("div"),this.slider.className="slider-metalamp__wrapper",this.track=document.createElement("div"),this.track.className="slider-metalamp__track",this.slider.append(this.track),this.frame=document.createElement("div"),this.frame.className="slider-metalamp__frame",this.slider.append(this.frame),this.root.after(this.slider)}init(t){this.conf=t,this.createSubViews(),this.createListeners(),this.switchVertical(t),this.switchRange(t),this.switchTip(t),this.switchScale(t),this.switchBar(t)}disable(){this.slider&&this.slider.classList.add("slider-metalamp__wrapper_disabled")}enable(){this.slider&&this.slider.classList.remove("slider-metalamp__wrapper_disabled")}updateFromPos(t,i){this.viewControl&&this.viewControl.controlMin&&(this.viewControl.updatePos(this.viewControl.controlMin,t.fromPosition),this.viewControl.updateInput(i),this.viewBar&&this.viewBar.updateBar(t.fromPosition,t.toPosition,i.range,i.vertical))}updateToPos(t,i){this.viewControl&&this.viewControl.controlMax&&(this.viewControl.updatePos(this.viewControl.controlMax,t.toPosition),this.viewControl.updateInput(i)),this.viewBar&&this.viewBar.updateBar(t.fromPosition,t.toPosition,i.range,i.vertical)}updateFromValue(t){this.viewControl&&this.viewControl.updateVal(t.fromValue,!0)}updateToValue(t){this.viewControl&&this.viewControl.updateVal(t.toValue,!1)}updateScale(t,i){this.viewScale&&this.viewScale.createScale(t.marksArray,i)}switchVertical(t){this.changeMode(t.vertical,"orientation_vertical"),this.viewControl&&this.viewControl.switchVertical(t)}switchRange(t,i={}){this.changeMode(!t.range,"range-mode_single"),"fromPosition"in i&&this.viewBar&&this.viewBar.updateBar(i.fromPosition,i.toPosition,t.range,t.vertical)}switchScale(t){this.changeMode(!t.scale,"scale-mode_hidden")}switchBar(t){this.changeMode(!t.bar,"bar-mode_hidden")}switchTip(t){this.changeMode(!t.tip,"tip-mode_hidden"),this.viewControl&&this.viewControl.switchTip(t)}changeMode(t,i){const s=`slider-metalamp__wrapper_${i}`;this.slider&&(t?this.slider.classList.add(s):this.slider.classList.remove(s))}collectParms(){this.dataAttributesConf={};const t=new Map,i=["min","max","from","to","step","interval","shiftonkeydown","shiftonkeyhold","scalebase","vertical","range","sticky","scale","bar","tip"];Array.from(this.root.attributes).forEach((s=>{const e=s.name.replace(/^data-/,"");-1!==i.indexOf(e)&&t.set(e,s.value)})),t.forEach(((i,s)=>{/^-?\d+\.?\d*$/.test(i)&&t.set(s,parseFloat(i)),"true"===i&&t.set(s,!0),"false"===i&&t.set(s,!1),"shiftonkeydown"===s&&(t.set("shiftOnKeyDown",i),t.delete(s)),"shiftonkeyhold"===s&&(t.set("shiftOnKeyHold",i),t.delete(s)),"scalebase"===s&&(t.set("scaleBase",i),t.delete(s))})),this.dataAttributesConf=Object.fromEntries(t.entries())}createSubViews(){this.slider&&this.track&&(this.viewControl=new c(this.slider,this.conf),this.viewScale=new d(this.slider,this.track,this.conf),this.viewBar=new r(this.slider))}createListeners(){this.viewControl&&(this.viewControl.subscribe(this.handleMoveEvent),this.viewControl.subscribe(this.handleKeydownEvent))}};class f extends e{constructor(t,i){super(),this.handleFromPosition=t=>{"FromPosition"===t.key&&this.view&&this.view.updateFromPos(t.data,t.conf)},this.handleToPosition=t=>{"ToPosition"===t.key&&this.view&&this.view.updateToPos(t.data,t.conf)},this.handleFromValue=t=>{"FromValue"===t.key&&this.view&&this.view.updateFromValue(t.data)},this.handleToValue=t=>{"ToValue"===t.key&&this.view&&this.view.updateToValue(t.data)},this.handleScale=t=>{"Scale"===t.key&&this.view&&this.view.updateScale(t.data,t.conf)},this.handleIsVertical=t=>{"IsVertical"===t.key&&this.view&&this.view.switchVertical(t.conf)},this.handleIsRange=t=>{"IsRange"===t.key&&this.view&&this.view.switchRange(t.conf,t.data)},this.handleIsScale=t=>{"IsScale"===t.key&&this.view&&this.view.switchScale(t.conf)},this.handleIsBar=t=>{"IsBar"===t.key&&this.view&&this.view.switchBar(t.conf)},this.handleIsTip=t=>{"IsTip"===t.key&&this.view&&this.view.switchTip(t.conf)},this.handleMoveEvent=t=>{"MoveEvent"===t.key&&this.model&&this.model.calcPositionSetByPointer(t.data.thumb)},this.handleKeydownEvent=t=>{"KeydownEvent"===t.key&&this.model&&this.model.calcPositionSetByKey(t.data.thumb)},this.model=t,this.view=i,this.createListeners(),this.init(),this.isEnabled=!0}update(t){this.model&&this.model.update(t)}getData(){return!this.model||this.model.getData()}disable(){this.view&&(this.removeListeners(),this.isEnabled=!1,this.view.disable())}enable(){!this.isEnabled&&this.view&&(this.createListeners(),this.view.enable()),this.isEnabled=!0}destroy(){this.view&&this.view.slider&&(this.view.slider.remove(),this.view=null,this.model=null)}init(){this.view&&this.model&&(this.model.getConf(this.view.dataAttributesConf),this.view.init(this.model.conf),this.model.start())}createListeners(){this.view&&this.model&&(this.model.subscribe(this.handleFromPosition),this.model.subscribe(this.handleToPosition),this.model.subscribe(this.handleFromValue),this.model.subscribe(this.handleToValue),this.model.subscribe(this.handleScale),this.model.subscribe(this.handleIsVertical),this.model.subscribe(this.handleIsRange),this.model.subscribe(this.handleIsScale),this.model.subscribe(this.handleIsBar),this.model.subscribe(this.handleIsTip),this.view.subscribe(this.handleMoveEvent),this.view.subscribe(this.handleKeydownEvent))}removeListeners(){this.view&&this.model&&(this.model.unsubscribe(this.handleFromPosition),this.model.unsubscribe(this.handleToPosition),this.model.unsubscribe(this.handleFromValue),this.model.unsubscribe(this.handleToValue),this.model.unsubscribe(this.handleScale),this.model.unsubscribe(this.handleIsVertical),this.model.unsubscribe(this.handleIsRange),this.model.unsubscribe(this.handleIsScale),this.model.unsubscribe(this.handleIsBar),this.model.unsubscribe(this.handleIsTip),this.view.unsubscribe(this.handleMoveEvent),this.view.unsubscribe(this.handleKeydownEvent))}}$.fn.SliderMetaLamp=function(t){return this.each(((i,s)=>{const e=$(s);e.data("SliderMetaLamp")||e.data("SliderMetaLamp",new f(new n(t),new m(s)))})),this}})();